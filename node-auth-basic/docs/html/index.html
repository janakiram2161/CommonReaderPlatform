<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Using ATECC508A for Node Authentication: Node Authentication Example using Asymmetric PKI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Using ATECC508A for Node Authentication
   </div>
   <div id="projectbrief">All-in-one project - Asymmetric Node Authentication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Node Authentication Example using Asymmetric PKI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Project: node-auth-basic.atsln</p>
<p>This is an all-in-one example which demonstrates the various stages of the node authentication sequence using public key, asymmetric techniques of Microchip CryptoAuthentication devices such as ATECC508A.</p>
<p>The node authentication stages demonstrated are:</p>
<ul>
<li>Provisioning the ATECC508A with Device and Signer Certificates and keys</li>
<li>Reconstruct X.509 certificates from data stored in the ATECC508A</li>
<li>Chain verify - verify of Device certificate linkage to the Root of Trust</li>
<li>Send challenge to the device</li>
<li>Device Signs challenge</li>
<li>Verify authenticity of signed challenge</li>
</ul>
<h2>What Is the Point of this Example? </h2>
<p>The combined result of the chain verify stage and the device challenge / response phase indicates if the node is authentic and can prove it is an original OEM device. It also shows one way a device may be provisioned to hold critical data for an X.509 certificate.</p>
<h2>For the Impatient - Where to Dive In? </h2>
<p>For the impatient reader, the code that implements each of the stages kicks off in <a class="el" href="a00044.html" title="Client and host high-level API for PKI node authentication with ATECC508A. ">node_auth.c</a>. The code uses Microchip CryptoAuthLib, a portable device driver to talk to the ATECC508A. With this example, you can walk through the entire sequence from top to bottom down to the driver level if need-be.</p>
<p>The HTML documentation for this example may be found in the node-auth-basic/docs directory. Load index.html with your browser to view the documentation for the node-auth-basic project.</p>
<p>The HTML documentation for CryptoAuthLib, the core crypto library for Microchip CryptoAuthentication devices, can be found in node-auth-basic/src/cryptoauthlib/docs/ . Load html/index.html in your browser to begin viewing the API docs for CryptoAuthLib.</p>
<h2>Prerequisites for this example </h2>
<p>Software:</p><ul>
<li>Atmel Studio 7</li>
</ul>
<p>Hardware:</p><ul>
<li>ATSAMD21-XPRO - SAM D21 Xplained Pro evaluation kit</li>
<li>AT88CK101 top board with socket or ATCRYPTOAUTH-XPRO CryptoAuth Xplained Pro extension board</li>
</ul>
<p>Plug the CryptoAuth Xplained Pro extension board into SAMD21 EXT1 or EXT2 header. The I2C pins of the SAMD21 Xplained Pro dev board will automatically be connected to the CryptoAuthXplained Pro and the firmware in this project will be ready to run the example.</p>
<h2>What is a Node? </h2>
<p>"Node" in this use-case refers to the device you want to authenticate. It could be an accessory or even a sensor in a network. <br />
 </p><h2>What does "all-in-one" mean? </h2>
<p>The "all-in-one" phrase implies that these stages are often not executed on the same device. For example, a node might be a 6LoWPAN device on a wireless network and the host is in a remote data-center.</p>
<p>However, there are use-cases where all runtime stages will be executed on the same host. For example, in a consumables use-case such as a printer / printer-cartridge, the host in the printer would perform all stages shown here and the ATECC508A is in the cartridge which is in direct electrical contact with the host.</p>
<p>The "all-in-one" example is a convenient way to watch how all the roles work together in a system similar to the printer/print-cartridge use case. All-in-one minimizes hardware and is the easiest way to trace all the code paths from one tool, Atmel Studio.</p>
<p>The example will clearly differentiate which roles are being performed at each stage.</p>
<h2>What are the roles demonstrated in this example? </h2>
<p>The all-in-one example demonstrates the following roles:</p><ul>
<li>Provisioner - the role that configures and programs the ATECC508A for runtime use.</li>
<li>Client - the device you want to authenticate, such as an accessory.</li>
<li>Host - the device which would perform the authentication and verification steps to insure the device is authentic.</li>
</ul>
<h1>Stages of Authentication </h1>
<h2>Provisioning </h2>
<p>Typically the provisioning stage is carried out at the production facility for the ATECC508A, but is included here to demonstrate the basic process used to configure the chip and store certificates.</p>
<h2>Reconstruction </h2>
<p>Reconstruction is the method used to take a small amount of data which is dynamically created as part of the certificate, stored within the ATECC508A, and reconstitutes that data into a fully valid X.509 valid certificate. <br />
 </p><h2>Chain verify, Root of Trust </h2>
<p>ECDSA verify of the Root of Trust is one phase of a full verification process which insures that this device has been properly signed into the manufacturer's chain of certificates. This chain would fail if any certificate were invalid or contained an incorrect information, public key, or signature. This verification process guards against an attacker forging a certificate within the chain to the Root of Trust.</p>
<h2>Signature Verify of Challenge </h2>
<p>ECDSA verify of the signed challenge involves the host sending a challenge (often a random number) to be cryptographically signed by the ATECC508A. A signature uses the private key held securely by the ATECC508A and cannot be read from the device.</p>
<p>The signature of the challenge is then verified using the public key of the device, the signature (response), and the challenge data itself.</p>
<p>Once all verifications are complete, the device is determined to be authentic or not authentic and the host can take an appropriate course based on that result.</p>
<h2>Building the Example Source Code </h2>
<p>Using Atmel Studio 7, you should load the project file:</p><ul>
<li>node-auth-basic.atsln</li>
</ul>
<p>Once the project has been loaded, you can build it with "Rebuild Solution" under the Build menu. Flash the SAMD21 Xplained Pro development board using the standard Atmel Studio device programming tools.</p>
<h2>Using the Node Auth Basic Example </h2>
<p>There are two USB ports on the SAMD21 Xplained Pro. One is labeled "EDBG USB" and is used to flash the code into the MCU with Atmel Studio. The second USB port is labeled "Target USB", a CDC USB port and is used for the console interface to the example.</p>
<p>Connect your host computer to the EDBG USB to program it. <br />
 Connect your host computer to the Target USB CDC port in order to see a console interface you can use to exercise the example after it has been programmed.</p>
<p>Use a terminal program on your host and connect it to the virtual com port of the SAMD21 Xplained Pro which should be created when you plug the Target USB CDC port into your PC, Linux, or OS X machine. This particular step will vary on each computer and operating system.</p>
<p>The communication parameters are:</p><ul>
<li>115,200 baud</li>
<li>8 bit word</li>
<li>No parity</li>
<li>1 stop bit</li>
</ul>
<p>Once you've connected to the serial usb you can type 'help' and see a command line console like this:</p>
<div class="fragment"><div class="line">$ help</div><div class="line">Usage:</div><div class="line">client-provision  - Configure and load certificate data onto ATECC device.</div><div class="line">client-build      - Read certificate data off ATECC device and rebuild full signer and device certificates.</div><div class="line">host-chain-verify - Verify the certificate chain from the client.</div><div class="line">host-gen-chal     - Generate challenge for the client.</div><div class="line">client-gen-resp   - Generate response to challenge from host.</div><div class="line">host-verify-resp  - Verify the client response to the challenge.</div><div class="line">Utility functions:</div><div class="line">lockstat - zone lock status</div><div class="line">lockcfg  - lock config zone</div><div class="line">lockdata - lock data and OTP zones</div><div class="line">info     - get the chip revision</div><div class="line">sernum   - get the chip serial number</div><div class="line"></div><div class="line">$</div></div><!-- fragment --><h2>Step 0 - Check Connectivity to ATECC508A </h2>
<p>Using the command console, you can use the 'info' or 'sernum' command to get the chip revision and serial number. These are both good tests to insure your board and ATECC508A can communicate with each other.</p>
<p>This is an example session of what you can expect to see. Your serial number will be different, of course.</p>
<div class="fragment"><div class="line">$ info</div><div class="line">revision:</div><div class="line">00 00 50 00</div><div class="line">$ sernum</div><div class="line">serial number:</div><div class="line">01 23 61 12 D9 2C A5 71 EE</div><div class="line">$</div></div><!-- fragment --><p>If you do not see identical revision or similar serial number, then please check your connections to the CryptoAuthXplained Pro extension board or the socketed top-board connected to the I2C pins of the SAMD21 Xplained Pro.</p>
<p>You must be able to perform this step successfully before proceeding to the next steps.</p>
<h2>Step 1 - "client-provision" - Provision your ATECC508A </h2>
<p>Type the command: client-provision</p>
<p>This is a one-time step which generates the keys in the ATECC508A as well as construct the certificates required to later do the verification steps.</p>
<p>The certificates created and stored in this step are the device's certificate and the signer's certificate.</p>
<p>Once the command is complete, all the certificates and keys will be stored and locked in the device. The device's configuration can not be changed afterwards, but it is configured to allow re-provisioning (generating new keys and certificates).</p>
<p>An example session with client-provision might look similar to this (don't worry about the exact bytes shown, yours will be different than these; the main point is that you can see that the various components have been created and have data.)</p>
<div class="fragment"><div class="line">Signer CA Public Key:</div><div class="line">02 54 9E 50 2F 7C 13 1E C5 DA 7A 8B BF 5E 0D 05</div><div class="line">E1 3D 8E 11 F4 F1 04 D2 F6 CE 41 44 FA 40 E6 D4</div><div class="line">02 3C A0 80 30 B1 DE F1 4A A7 CE A3 FF 12 4B 4B</div><div class="line">A5 91 E0 F1 59 EF 67 A9 68 E5 CC 5C 0B FD E8 7A</div><div class="line">Signer Public Key:</div><div class="line">A3 AC C0 2F 35 17 15 08 68 B1 10 43 24 F9 EA 30</div><div class="line">17 2C B1 11 AB A1 F0 B5 0B 4B 85 77 2B F3 14 08</div><div class="line">70 C0 69 8E AF AA 6A 58 F9 8E 22 0F 3A 9E F8 35</div><div class="line">C0 6A 5D FB C5 25 F4 56 5A A7 AB A9 E9 B1 44 E6</div><div class="line">Device Public Key:</div><div class="line">B9 17 F9 9F BA A0 AF 3C 67 61 B8 DB D8 2F 8E 6B</div><div class="line">C1 CB D0 CF 87 82 08 0E 2B D3 EC EF E8 E9 C5 3B</div><div class="line">E2 1C 2E 5D CC A1 92 A5 A1 22 68 EA FF 94 68 F5</div><div class="line">C0 54 DD 32 40 F9 F6 C2 9B AF 0D 46 36 EC 5F 26</div><div class="line">Signer Certificate:</div><div class="line">30 82 01 B1 30 82 01 57 A0 03 02 01 02 02 03 40</div><div class="line">C4 8B 30 0A 06 08 2A 86 48 CE 3D 04 03 02 30 36</div><div class="line">31 10 30 0E 06 03 55 04 0A 0C 07 45 78 61 6D 70</div><div class="line">6C 65 31 22 30 20 06 03 55 04 03 0C 19 45 78 61</div><div class="line">6D 70 6C 65 20 41 54 45 43 43 35 30 38 41 20 52</div><div class="line">6F 6F 74 20 43 41 30 1E 17 0D 31 34 30 38 30 32</div><div class="line">32 30 30 30 30 30 5A 17 0D 33 34 30 38 30 32 32</div><div class="line">30 30 30 30 30 5A 30 3A 31 10 30 0E 06 03 55 04</div><div class="line">0A 0C 07 45 78 61 6D 70 6C 65 31 26 30 24 06 03</div><div class="line">55 04 03 0C 1D 45 78 61 6D 70 6C 65 20 41 54 45</div><div class="line">43 43 35 30 38 41 20 53 69 67 6E 65 72 20 43 34</div><div class="line">38 42 30 59 30 13 06 07 2A 86 48 CE 3D 02 01 06</div><div class="line">08 2A 86 48 CE 3D 03 01 07 03 42 00 04 A3 AC C0</div><div class="line">2F 35 17 15 08 68 B1 10 43 24 F9 EA 30 17 2C B1</div><div class="line">11 AB A1 F0 B5 0B 4B 85 77 2B F3 14 08 70 C0 69</div><div class="line">8E AF AA 6A 58 F9 8E 22 0F 3A 9E F8 35 C0 6A 5D</div><div class="line">FB C5 25 F4 56 5A A7 AB A9 E9 B1 44 E6 A3 50 30</div><div class="line">4E 30 0C 06 03 55 1D 13 04 05 30 03 01 01 FF 30</div><div class="line">1D 06 03 55 1D 0E 04 16 04 14 BB 5C 3D F7 4D 4C</div><div class="line">93 D4 2B 50 D1 7F B3 23 C3 3A B0 2C 27 BA 30 1F</div><div class="line">06 03 55 1D 23 04 18 30 16 80 14 14 B0 97 8A 1D</div><div class="line">57 50 FF 52 F9 DF A8 90 60 77 60 C5 3C 6B 50 30</div><div class="line">0A 06 08 2A 86 48 CE 3D 04 03 02 03 48 00 30 45</div><div class="line">02 21 00 FB 08 10 99 B3 F0 A8 E5 D5 19 3F 1A A2</div><div class="line">20 94 06 A1 63 D9 4A CE 18 6A 80 C6 6A E7 91 42</div><div class="line">6C 58 7D 02 20 46 85 5F 9D 71 F2 B9 48 84 75 2E</div><div class="line">49 2F D7 58 AD 1B EB BD 36 A5 74 64 2B 6B EA 02</div><div class="line">26 5A 72 13 3F</div><div class="line">Device Certificate:</div><div class="line">30 82 01 8A 30 82 01 30 A0 03 02 01 02 02 0A 40</div><div class="line">01 23 6F 12 D9 2C A5 71 EE 30 0A 06 08 2A 86 48</div><div class="line">CE 3D 04 03 02 30 3A 31 10 30 0E 06 03 55 04 0A</div><div class="line">0C 07 45 78 61 6D 70 6C 65 31 26 30 24 06 03 55</div><div class="line">04 03 0C 1D 45 78 61 6D 70 6C 65 20 41 54 45 43</div><div class="line">43 35 30 38 41 20 53 69 67 6E 65 72 20 43 34 38</div><div class="line">42 30 1E 17 0D 31 35 30 39 30 33 32 31 30 30 30</div><div class="line">30 5A 17 0D 33 35 30 39 30 33 32 31 30 30 30 30</div><div class="line">5A 30 35 31 10 30 0E 06 03 55 04 0A 0C 07 45 78</div><div class="line">61 6D 70 6C 65 31 21 30 1F 06 03 55 04 03 0C 18</div><div class="line">45 78 61 6D 70 6C 65 20 41 54 45 43 43 35 30 38</div><div class="line">41 20 44 65 76 69 63 65 30 59 30 13 06 07 2A 86</div><div class="line">48 CE 3D 02 01 06 08 2A 86 48 CE 3D 03 01 07 03</div><div class="line">42 00 04 B9 17 F9 9F BA A0 AF 3C 67 61 B8 DB D8</div><div class="line">2F 8E 6B C1 CB D0 CF 87 82 08 0E 2B D3 EC EF E8</div><div class="line">E9 C5 3B E2 1C 2E 5D CC A1 92 A5 A1 22 68 EA FF</div><div class="line">94 68 F5 C0 54 DD 32 40 F9 F6 C2 9B AF 0D 46 36</div><div class="line">EC 5F 26 A3 23 30 21 30 1F 06 03 55 1D 23 04 18</div><div class="line">30 16 80 14 BB 5C 3D F7 4D 4C 93 D4 2B 50 D1 7F</div><div class="line">B3 23 C3 3A B0 2C 27 BA 30 0A 06 08 2A 86 48 CE</div><div class="line">3D 04 03 02 03 48 00 30 45 02 20 35 96 2E 3F F4</div><div class="line">1A 3A DA E7 6F E1 FE 9D 7A 83 BE 36 FA 06 C5 01</div><div class="line">79 55 F2 2C 8C FE 1D 43 38 19 CC 02 21 00 E8 53</div><div class="line">87 83 A6 98 21 8E 43 A0 08 73 B3 FD B4 4B 7E 1C</div><div class="line">EC FB 61 33 52 59 99 DF B1 E1 79 3E D7 8B</div><div class="line">$</div></div><!-- fragment --><h2>Step 2 - "client-build" - Read Certificates from the ATECC508A </h2>
<p>Type the command: client-build</p>
<p>client-build will read the certificate data from the ATECC508A and reconstruct them into X.509 DER format certificates. For this demonstration, you won't have to parse the full certificate, the demo code will use the X.509 DER formats for its verification and validation steps.</p>
<p>A typical client-build session would look like this. If you want, you can compare this output to the certificates shown during the client provisioning step. They should be the same. In this step, the certificate data was read from the chip and reconstructed to match what was intended when the part was provisioned.</p>
<div class="fragment"><div class="line">CLIENT: Rebuilt Signer Certificate:</div><div class="line">30 82 01 B1 30 82 01 57 A0 03 02 01 02 02 03 40</div><div class="line">C4 8B 30 0A 06 08 2A 86 48 CE 3D 04 03 02 30 36</div><div class="line">31 10 30 0E 06 03 55 04 0A 0C 07 45 78 61 6D 70</div><div class="line">6C 65 31 22 30 20 06 03 55 04 03 0C 19 45 78 61</div><div class="line">6D 70 6C 65 20 41 54 45 43 43 35 30 38 41 20 52</div><div class="line">6F 6F 74 20 43 41 30 1E 17 0D 31 34 30 38 30 32</div><div class="line">32 30 30 30 30 30 5A 17 0D 33 34 30 38 30 32 32</div><div class="line">30 30 30 30 30 5A 30 3A 31 10 30 0E 06 03 55 04</div><div class="line">0A 0C 07 45 78 61 6D 70 6C 65 31 26 30 24 06 03</div><div class="line">55 04 03 0C 1D 45 78 61 6D 70 6C 65 20 41 54 45</div><div class="line">43 43 35 30 38 41 20 53 69 67 6E 65 72 20 43 34</div><div class="line">38 42 30 59 30 13 06 07 2A 86 48 CE 3D 02 01 06</div><div class="line">08 2A 86 48 CE 3D 03 01 07 03 42 00 04 A3 AC C0</div><div class="line">2F 35 17 15 08 68 B1 10 43 24 F9 EA 30 17 2C B1</div><div class="line">11 AB A1 F0 B5 0B 4B 85 77 2B F3 14 08 70 C0 69</div><div class="line">8E AF AA 6A 58 F9 8E 22 0F 3A 9E F8 35 C0 6A 5D</div><div class="line">FB C5 25 F4 56 5A A7 AB A9 E9 B1 44 E6 A3 50 30</div><div class="line">4E 30 0C 06 03 55 1D 13 04 05 30 03 01 01 FF 30</div><div class="line">1D 06 03 55 1D 0E 04 16 04 14 BB 5C 3D F7 4D 4C</div><div class="line">93 D4 2B 50 D1 7F B3 23 C3 3A B0 2C 27 BA 30 1F</div><div class="line">06 03 55 1D 23 04 18 30 16 80 14 14 B0 97 8A 1D</div><div class="line">57 50 FF 52 F9 DF A8 90 60 77 60 C5 3C 6B 50 30</div><div class="line">0A 06 08 2A 86 48 CE 3D 04 03 02 03 48 00 30 45</div><div class="line">02 21 00 FB 08 10 99 B3 F0 A8 E5 D5 19 3F 1A A2</div><div class="line">20 94 06 A1 63 D9 4A CE 18 6A 80 C6 6A E7 91 42</div><div class="line">6C 58 7D 02 20 46 85 5F 9D 71 F2 B9 48 84 75 2E</div><div class="line">49 2F D7 58 AD 1B EB BD 36 A5 74 64 2B 6B EA 02</div><div class="line">26 5A 72 13 3F</div><div class="line">CLIENT: Rebuilt Device Certificate:</div><div class="line">30 82 01 8A 30 82 01 30 A0 03 02 01 02 02 0A 40</div><div class="line">01 23 6F 12 D9 2C A5 71 EE 30 0A 06 08 2A 86 48</div><div class="line">CE 3D 04 03 02 30 3A 31 10 30 0E 06 03 55 04 0A</div><div class="line">0C 07 45 78 61 6D 70 6C 65 31 26 30 24 06 03 55</div><div class="line">04 03 0C 1D 45 78 61 6D 70 6C 65 20 41 54 45 43</div><div class="line">43 35 30 38 41 20 53 69 67 6E 65 72 20 43 34 38</div><div class="line">42 30 1E 17 0D 31 35 30 39 30 33 32 31 30 30 30</div><div class="line">30 5A 17 0D 33 35 30 39 30 33 32 31 30 30 30 30</div><div class="line">5A 30 35 31 10 30 0E 06 03 55 04 0A 0C 07 45 78</div><div class="line">61 6D 70 6C 65 31 21 30 1F 06 03 55 04 03 0C 18</div><div class="line">45 78 61 6D 70 6C 65 20 41 54 45 43 43 35 30 38</div><div class="line">41 20 44 65 76 69 63 65 30 59 30 13 06 07 2A 86</div><div class="line">48 CE 3D 02 01 06 08 2A 86 48 CE 3D 03 01 07 03</div><div class="line">42 00 04 B9 17 F9 9F BA A0 AF 3C 67 61 B8 DB D8</div><div class="line">2F 8E 6B C1 CB D0 CF 87 82 08 0E 2B D3 EC EF E8</div><div class="line">E9 C5 3B E2 1C 2E 5D CC A1 92 A5 A1 22 68 EA FF</div><div class="line">94 68 F5 C0 54 DD 32 40 F9 F6 C2 9B AF 0D 46 36</div><div class="line">EC 5F 26 A3 23 30 21 30 1F 06 03 55 1D 23 04 18</div><div class="line">30 16 80 14 BB 5C 3D F7 4D 4C 93 D4 2B 50 D1 7F</div><div class="line">B3 23 C3 3A B0 2C 27 BA 30 0A 06 08 2A 86 48 CE</div><div class="line">3D 04 03 02 03 48 00 30 45 02 20 35 96 2E 3F F4</div><div class="line">1A 3A DA E7 6F E1 FE 9D 7A 83 BE 36 FA 06 C5 01</div><div class="line">79 55 F2 2C 8C FE 1D 43 38 19 CC 02 21 00 E8 53</div><div class="line">87 83 A6 98 21 8E 43 A0 08 73 B3 FD B4 4B 7E 1C</div><div class="line">EC FB 61 33 52 59 99 DF B1 E1 79 3E D7 8B</div><div class="line">$</div></div><!-- fragment --><h2>Step 3 - "host-chain-verify" - Verify the Certificate Chain </h2>
<p>Type the command: host-chain-verify</p>
<p>host-chain-verify will retrieve the device certificate and the signer certificate from the ATECC508A, reconstruct the certificates, and then perform a chain verify which verifies that the device certificate is valid and has been signed into the chain leading to a Root of Trust.</p>
<p>A typical host-chain-verify session will look like this:</p>
<div class="fragment"><div class="line">$ host-chain-verify</div><div class="line">HOST: Signer certificate verified against signer certificate authority (CA) public key!</div><div class="line">HOST: Device certificate verified against signer public key!</div></div><!-- fragment --><h2>Step 4 - "host-gen-chal" - Generate a challenge from the Host </h2>
<p>Type the command: host-gen-chal</p>
<p>host-gen-chal will generate a random challenge and ask the ATECC508A to sign it using the private key stored in the ATECC508A corresponding to the device certificate.</p>
<p>This is one half of the typical "challenge / response" pattern. After the response has been received (see Step 5), an ECDSA verification can be performed which does the math to determine if the signature was valid.</p>
<p>A challenge will look like this:</p>
<div class="fragment"><div class="line">$ host-gen-chal</div><div class="line">HOST: Generated challenge:</div><div class="line">14 84 E8 89 41 D5 9A 1C AD 1F 68 44 3A 09 C6 45</div><div class="line">30 BF 27 38 D2 28 56 B7 DD D6 98 CF 92 AB 3D 69</div></div><!-- fragment --><h2>Step 5 - "client-gen-resp" - Generate the response to the challenge (signature) </h2>
<p>Type the command: client-gen-resp</p>
<p>client-gen-resp will generate the signature of the challenge performed in Step</p><ol type="1">
<li>It requests that the ATECC508A sign the challenge and return the signature it generated. This signature will be used in the verification steps next.</li>
</ol>
<p>The generation of the signature will look like this:</p>
<div class="fragment"><div class="line">$ client-gen-resp</div><div class="line">CLIENT: Calculated response to host challenge:</div><div class="line">BB BD 18 73 C3 88 86 E7 86 4A 53 CF 8F 18 4D EC</div><div class="line">1A 39 A2 B9 FC 0B FE 73 CE 51 42 0C FB 81 26 F9</div><div class="line">63 C1 A0 AF A8 67 58 FB 3B 9D 19 6B FE 86 98 47</div><div class="line">0C 13 C9 95 8D 37 C9 47 57 61 A0 F7 D4 52 42 45</div></div><!-- fragment --><h2>Step 6 - "host-verify-resp" - Verify the Signature </h2>
<p>Type the command: host-verify-resp</p>
<p>host-verify-resp will perform an ECDSA verification to determine if the signature (response) was valid. ECDSA verification requires three pieces of data:</p><ul>
<li>Public key of the device</li>
<li>Challenge given to the device to sign</li>
<li>Signature (response) of the challenge</li>
</ul>
<p>If the ECDSA verification step verifies the device, the device has proven that it has the private key associated with the public key that is in its device certificate and signed into the certificate chain. That's a long way of saying that it has proven that it owns the public key and if its certificate with the same public key passes the chain verification, then device is considered fully verified.</p>
<p>This is the final device verification step: </p><div class="fragment"><div class="line">$ host-verify-resp</div><div class="line">CLIENT: Calculated response to host challenge:</div><div class="line">BB BD 18 73 C3 88 86 E7 86 4A 53 CF 8F 18 4D EC</div><div class="line">1A 39 A2 B9 FC 0B FE 73 CE 51 42 0C FB 81 26 F9</div><div class="line">63 C1 A0 AF A8 67 58 FB 3B 9D 19 6B FE 86 98 47</div><div class="line">0C 13 C9 95 8D 37 C9 47 57 61 A0 F7 D4 52 42 45</div><div class="line">HOST: Device public key from certificate:</div><div class="line">B9 17 F9 9F BA A0 AF 3C 67 61 B8 DB D8 2F 8E 6B</div><div class="line">C1 CB D0 CF 87 82 08 0E 2B D3 EC EF E8 E9 C5 3B</div><div class="line">E2 1C 2E 5D CC A1 92 A5 A1 22 68 EA FF 94 68 F5</div><div class="line">C0 54 DD 32 40 F9 F6 C2 9B AF 0D 46 36 EC 5F 26</div><div class="line">HOST: Device response to challenge verified!</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
